---
import Layout from "@/layouts/Layout.astro";

const headers = [
	
    { name: "Titulo", key: 'titulo'},
	{ name: "Usuario", key: 'usuario'},
	{ name: "Ultima Modificación", key: 'updatedAt'},
]

import MantenanceLayout from '@/components/Mantenances/Anecdotas/MantenanceLayout'

const messages = {
    delete: "¿Está seguro que desea eliminar esta anecdota?",
    pending: "Eliminando anecdota...",
    success: "Anecdota eliminado correctamente",
    error: "Error al eliminar la anecdota"
}

import { getAnecdotas, deleteAnecdota} from '@/api/anectodas';

const anecdotas = await getAnecdotas();

console.log(anecdotas);

const anecdotaData = anecdotas.map((anecdota) => {
    return {
        id: anecdota._id,
		titulo: anecdota.titulo,
        usuario: anecdota.usuario.nombres + ' ' + anecdota.usuario.apellidos,
		updatedAt: new Date(anecdota.updatedAt).toLocaleDateString(
    				"es-ES",
    				{ year: "numeric", month: "long", day: "numeric" })
    }
})
---

<Layout title="admin - Anecdotas">
    <main>
			<MantenanceLayout 
				title="Mantenimiento de Anecdotas"
				headers={headers}
				data={anecdotaData}
				messages={messages}
				client:load
				client:only
			/>
    </main>
</Layout>

<style>
	main {
		flex: 1;
		height: 100%;
		width: 100%;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: flex-start;
        gap: 1rem;
        overflow-y: auto;;
	}


</style>